<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>æŠ•å½±å›³ã‚¯ã‚¤ã‚ºï¼šã“ã®ç«‹ä½“ãªãƒ¼ã‚“ã ï¼Ÿ</title>
  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- React & ReactDOM -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <!-- Babel -->
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <style>
    /* ãµã‚ã£ã¨è¡¨ç¤ºã•ã›ã‚‹ãŸã‚ã®ç°¡å˜ãªã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ */
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(-5px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .animate-fade-in {
      animation: fadeIn 0.3s ease-out forwards;
    }
  </style>
</head>
<body class="bg-gray-100 min-h-screen">
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect } = React;

    // --- ã‚¢ã‚¤ã‚³ãƒ³ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ ---
    const Icon = ({ children, size = 24, className = "" }) => (
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" width={size} height={size} className={className}>
        {children}
      </svg>
    );
    const RefreshCw = (props) => <Icon {...props}><polyline points="23 4 23 10 17 10"></polyline><polyline points="1 20 1 14 7 14"></polyline><path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"></path></Icon>;
    const ArrowRight = (props) => <Icon {...props}><line x1="5" y1="12" x2="19" y2="12"></line><polyline points="12 5 19 12 12 19"></polyline></Icon>;
    const HelpCircle = (props) => <Icon {...props}><circle cx="12" cy="12" r="10"></circle><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path><line x1="12" y1="17" x2="12.01" y2="17"></line></Icon>;
    const CheckCircle = (props) => <Icon {...props}><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path><polyline points="22 4 12 14.01 9 11.01"></polyline></Icon>;
    const XCircle = (props) => <Icon {...props}><circle cx="12" cy="12" r="10"></circle><line x1="15" y1="9" x2="9" y2="15"></line><line x1="9" y1="9" x2="15" y2="15"></line></Icon>;
    const Clock = (props) => <Icon {...props}><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></Icon>;
    const Trophy = (props) => <Icon {...props}><path d="M6 9H4.5a2.5 2.5 0 0 1 0-5H6"></path><path d="M18 9h1.5a2.5 2.5 0 0 0 0-5H18"></path><path d="M4 22h16"></path><path d="M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22"></path><path d="M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22"></path><path d="M18 2H6v7a6 6 0 0 0 12 0V2Z"></path></Icon>;

    // --- ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ ---
    const ShapeQuiz = () => {
      // ã‚²ãƒ¼ãƒ ã®çŠ¶æ…‹ç®¡ç†
      const [mode, setMode] = useState('basic');
      const [quizStatus, setQuizStatus] = useState('playing'); // 'playing' ã‹ 'result'
      
      const [currentIndex, setCurrentIndex] = useState(0);
      const [selectedOptionId, setSelectedOptionId] = useState(null);
      const [isAnswered, setIsAnswered] = useState(false);

      // ã‚¹ã‚³ã‚¢ã¨ã‚¿ã‚¤ãƒãƒ¼
      const [score, setScore] = useState(0);
      const [startTime, setStartTime] = useState(Date.now());
      const [timeTaken, setTimeTaken] = useState(0); // ã‚¯ãƒªã‚¢ã¾ã§ã«ã‹ã‹ã£ãŸç§’æ•°

      // ==========================================
      // åŸºæœ¬ãƒ¬ãƒ™ãƒ« ãƒ‡ãƒ¼ã‚¿ (8å•)
      // ==========================================
      const basicOptions = [
        { id: "cone", label: "å††éŒ", yomi: "ãˆã‚“ã™ã„" },
        { id: "sphere", label: "çƒ", yomi: "ãã‚…ã†" },
        { id: "hemisphere", label: "åŠçƒ", yomi: "ã¯ã‚“ãã‚…ã†" },
        { id: "cylinder", label: "å††æŸ±", yomi: "ãˆã‚“ã¡ã‚…ã†" },
        { id: "rect_prism", label: "å››è§’æŸ±", yomi: "ã—ã‹ãã¡ã‚…ã†" },
        { id: "rect_pyramid", label: "å››è§’éŒ", yomi: "ã—ã‹ãã™ã„" },
        { id: "tri_prism", label: "ä¸‰è§’æŸ±", yomi: "ã•ã‚“ã‹ãã¡ã‚…ã†" },
        { id: "tri_pyramid", label: "ä¸‰è§’éŒ", yomi: "ã•ã‚“ã‹ãã™ã„" }
      ];

      const basicQuestionsData = [
        {
          id: "cone",
          answerDisplay: "å††éŒï¼ˆãˆã‚“ã™ã„ï¼‰",
          description: "ã¨ã‚“ãŒã‚Šå¸½å­ã®ã‚ˆã†ãªå½¢ã§ã™ã€‚",
          hint: "ç«‹é¢å›³ï¼ˆæ­£é¢ï¼‰ã¯ä¸‰è§’å½¢ã€å¹³é¢å›³ï¼ˆä¸Šï¼‰ã¯å††ã§ã™ã€‚ä¸­å¿ƒã®ç‚¹ã¯é ‚ç‚¹ã‚’è¡¨ã—ã¦ã„ã¾ã™ã€‚",
          svgContent: (
            <g>
              <path d="M50,20 L20,80 L80,80 Z" fill="none" stroke="black" strokeWidth="2" />
              <circle cx="50" cy="130" r="30" fill="none" stroke="black" strokeWidth="2" />
              <circle cx="50" cy="130" r="2" fill="black" />
            </g>
          )
        },
        {
          id: "sphere",
          answerDisplay: "çƒï¼ˆãã‚…ã†ï¼‰",
          description: "ã©ã“ã‹ã‚‰è¦‹ã¦ã‚‚åŒã˜å½¢ã§ã™ã€‚",
          hint: "æ­£é¢ã‹ã‚‰è¦‹ã¦ã‚‚ã€ä¸Šã‹ã‚‰è¦‹ã¦ã‚‚ã€Œå††ã€ã«è¦‹ãˆã‚‹ç«‹ä½“ã¯ä½•ã§ã—ã‚‡ã†ã‹ï¼Ÿ",
          svgContent: (
            <g>
              <circle cx="50" cy="50" r="30" fill="none" stroke="black" strokeWidth="2" />
              <circle cx="50" cy="130" r="30" fill="none" stroke="black" strokeWidth="2" />
            </g>
          )
        },
        {
          id: "hemisphere",
          answerDisplay: "åŠçƒï¼ˆã¯ã‚“ãã‚…ã†ï¼‰",
          description: "çƒã‚’åŠåˆ†ã«åˆ‡ã£ãŸå½¢ã§ã™ã€‚",
          hint: "æ­£é¢ã‹ã‚‰è¦‹ã‚‹ã¨åŠå††ï¼ˆå¼“å½¢ï¼‰ã€ä¸Šã‹ã‚‰è¦‹ã‚‹ã¨å††ã«è¦‹ãˆã¾ã™ã€‚",
          svgContent: (
            <g>
              <path d="M20,80 A30,30 0 0,1 80,80 Z" fill="none" stroke="black" strokeWidth="2" />
              <circle cx="50" cy="130" r="30" fill="none" stroke="black" strokeWidth="2" />
            </g>
          )
        },
        {
          id: "cylinder",
          answerDisplay: "å††æŸ±ï¼ˆãˆã‚“ã¡ã‚…ã†ï¼‰",
          description: "ç©ºãç¼¶ã®ã‚ˆã†ãªå½¢ã§ã™ã€‚",
          hint: "æ­£é¢ã‹ã‚‰ã¯å››è§’å½¢ã«è¦‹ãˆã¾ã™ãŒã€ä¸Šã‹ã‚‰è¦‹ã‚‹ã¨å††ã§ã™ã€‚å¤ªã•ã¯ä¸Šã‹ã‚‰ä¸‹ã¾ã§åŒã˜ã§ã™ã€‚",
          svgContent: (
            <g>
              <rect x="20" y="20" width="60" height="60" fill="none" stroke="black" strokeWidth="2" />
              <circle cx="50" cy="130" r="30" fill="none" stroke="black" strokeWidth="2" />
            </g>
          )
        },
        {
          id: "rect_prism",
          answerDisplay: "å››è§’æŸ±ï¼ˆã—ã‹ãã¡ã‚…ã†ï¼‰",
          description: "ç®±ã®ã‚ˆã†ãªå½¢ã§ã™ï¼ˆã“ã“ã§ã¯æ­£å››è§’æŸ±ï¼‰ã€‚",
          hint: "æ­£é¢ã‚‚å››è§’ã€ä¸Šã‹ã‚‰è¦‹ã¦ã‚‚å››è§’ã€‚æŸ±ï¼ˆã¯ã—ã‚‰ï¼‰ã®ã‚ˆã†ã«å¤ªã•ãŒå¤‰ã‚ã‚Šã¾ã›ã‚“ã€‚",
          svgContent: (
            <g>
              <rect x="20" y="20" width="60" height="60" fill="none" stroke="black" strokeWidth="2" />
              <rect x="20" y="100" width="60" height="60" fill="none" stroke="black" strokeWidth="2" />
            </g>
          )
        },
        {
          id: "rect_pyramid",
          answerDisplay: "å››è§’éŒï¼ˆã—ã‹ãã™ã„ï¼‰",
          description: "ãƒ”ãƒ©ãƒŸãƒƒãƒ‰ã®ã‚ˆã†ãªå½¢ã§ã™ã€‚",
          hint: "æ­£é¢ã¯ä¸‰è§’å½¢ã§ã€ä¸Šã‹ã‚‰è¦‹ã‚‹ã¨å››è§’å½¢ã§ã™ã€‚å¹³é¢å›³ã®ã€ŒÃ—ã€å°ã¯ã€å´é¢ã®ç¨œç·šï¼ˆã‚Šã‚‡ã†ã›ã‚“ï¼‰ãŒè¦‹ãˆã¦ã„ã‚‹ã“ã¨ã‚’è¡¨ã—ã¾ã™ã€‚",
          svgContent: (
            <g>
              <path d="M50,20 L20,80 L80,80 Z" fill="none" stroke="black" strokeWidth="2" />
              <rect x="20" y="100" width="60" height="60" fill="none" stroke="black" strokeWidth="2" />
              <line x1="20" y1="100" x2="80" y2="160" stroke="black" strokeWidth="2" />
              <line x1="80" y1="100" x2="20" y2="160" stroke="black" strokeWidth="2" />
            </g>
          )
        },
        {
          id: "tri_prism",
          answerDisplay: "ä¸‰è§’æŸ±ï¼ˆã•ã‚“ã‹ãã¡ã‚…ã†ï¼‰",
          description: "ã‚±ãƒ¼ã‚­ã‚’å€’ã—ãŸã‚ˆã†ãªå½¢ã€ã‚ã‚‹ã„ã¯ä¸‰è§’å®šè¦ã®ã‚±ãƒ¼ã‚¹ã®ã‚ˆã†ãªå½¢ã§ã™ã€‚",
          hint: "æ­£é¢ã‹ã‚‰è¦‹ã‚‹ã¨å››è§’å½¢ã§ã™ãŒã€ä¸Šã‹ã‚‰è¦‹ã‚‹ã¨ä¸‰è§’å½¢ã§ã™ã€‚",
          svgContent: (
            <g>
              <rect x="20" y="20" width="60" height="60" fill="none" stroke="black" strokeWidth="2" />
              <path d="M20,160 L50,100 L80,160 Z" fill="none" stroke="black" strokeWidth="2" />
            </g>
          )
        },
        {
          id: "tri_pyramid",
          answerDisplay: "ä¸‰è§’éŒï¼ˆã•ã‚“ã‹ãã™ã„ï¼‰",
          description: "ã™ã¹ã¦ã®é¢ãŒä¸‰è§’å½¢ã§ã§ãã¦ã„ã‚‹å½¢ï¼ˆæ­£å››é¢ä½“ãªã©ï¼‰ã§ã™ã€‚",
          hint: "æ­£é¢ã‚‚ä¸Šã‚‚ä¸‰è§’å½¢ã§ã™ã€‚å¹³é¢å›³ã®å†…å´ã®ç·šã¯ã€é ‚ç‚¹ã‹ã‚‰åº•é¢ã®è§’ã¸ä¼¸ã³ã‚‹è¾ºã‚’è¡¨ã—ã¦ã„ã¾ã™ã€‚",
          svgContent: (
            <g>
              <path d="M50,20 L20,80 L80,80 Z" fill="none" stroke="black" strokeWidth="2" />
              <path d="M20,160 L50,100 L80,160 Z" fill="none" stroke="black" strokeWidth="2" />
              <line x1="20" y1="160" x2="50" y2="135" stroke="black" strokeWidth="2" />
              <line x1="80" y1="160" x2="50" y2="135" stroke="black" strokeWidth="2" />
              <line x1="50" y1="100" x2="50" y2="135" stroke="black" strokeWidth="2" />
            </g>
          )
        }
      ];

      // ==========================================
      // ç™ºå±•ãƒ¬ãƒ™ãƒ« ãƒ‡ãƒ¼ã‚¿ (10å•)
      // ==========================================
      const advancedOptions = [
        { id: "cone_frustum", label: "å††éŒå°", yomi: "ãˆã‚“ã™ã„ã ã„" },
        { id: "pyramid_frustum", label: "å››è§’éŒå°", yomi: "ã—ã‹ãã™ã„ã ã„" },
        { id: "hex_prism", label: "å…­è§’æŸ±", yomi: "ã‚ã£ã‹ãã¡ã‚…ã†" },
        { id: "hex_pyramid", label: "å…­è§’éŒ", yomi: "ã‚ã£ã‹ãã™ã„" },
        { id: "half_cylinder", label: "ã‹ã¾ã¼ã“å‹", yomi: "åŠå††æŸ±" },
        { id: "pipe", label: "ãƒ‘ã‚¤ãƒ—", yomi: "ä¸­ç©ºå††æŸ±" },
        { id: "l_block", label: "Lå­—å‹ãƒ–ãƒ­ãƒƒã‚¯", yomi: "ãˆã‚‹ã˜ãŒãŸ" },
        { id: "step_block", label: "éšæ®µå‹", yomi: "ã‹ã„ã ã‚“ãŒãŸ" },
        { id: "t_block", label: "å‡¸å‹ãƒ–ãƒ­ãƒƒã‚¯", yomi: "ã¨ã¤ãŒãŸ" },
        { id: "house_block", label: "å®¶å‹ãƒ–ãƒ­ãƒƒã‚¯", yomi: "å¯ã‹ã›ãŸäº”è§’æŸ±" }
      ];

      const advancedQuestionsData = [
        {
          id: "cone_frustum",
          answerDisplay: "å††éŒå°ï¼ˆãˆã‚“ã™ã„ã ã„ï¼‰",
          description: "ãƒ—ãƒªãƒ³ã®ã‚ˆã†ãªå½¢ã€‚å††éŒã®é ­ã‚’ã‚¹ãƒ‘ãƒƒã¨åˆ‡ã‚Šè½ã¨ã—ãŸå½¢ã§ã™ã€‚",
          hint: "ä¸Šã‹ã‚‰è¦‹ã‚‹ã¨å¤§å°ï¼’ã¤ã®å††ãŒè¦‹ãˆã¾ã™ã€‚",
          svgContent: (
            <g>
              <path d="M35,20 L65,20 L80,80 L20,80 Z" fill="none" stroke="black" strokeWidth="2" />
              <circle cx="50" cy="130" r="30" fill="none" stroke="black" strokeWidth="2" />
              <circle cx="50" cy="130" r="15" fill="none" stroke="black" strokeWidth="2" />
            </g>
          )
        },
        {
          id: "pyramid_frustum",
          answerDisplay: "å››è§’éŒå°ï¼ˆã—ã‹ãã™ã„ã ã„ï¼‰",
          description: "ãƒ”ãƒ©ãƒŸãƒƒãƒ‰ã®é ‚ä¸Šã‚’åˆ‡ã‚Šè½ã¨ã—ãŸã‚ˆã†ãªå½¢ã§ã™ã€‚",
          hint: "æ­£é¢ã¯å°å½¢ã€‚ä¸Šã‹ã‚‰è¦‹ã‚‹ã¨ã€ï¼’ã¤ã®å››è§’å½¢ã¨è§’ã‚’çµã¶ç·šãŒè¦‹ãˆã¾ã™ã€‚",
          svgContent: (
            <g>
              <path d="M35,20 L65,20 L80,80 L20,80 Z" fill="none" stroke="black" strokeWidth="2" />
              <rect x="20" y="100" width="60" height="60" fill="none" stroke="black" strokeWidth="2" />
              <rect x="35" y="115" width="30" height="30" fill="none" stroke="black" strokeWidth="2" />
              <line x1="20" y1="100" x2="35" y2="115" stroke="black" strokeWidth="2" />
              <line x1="80" y1="100" x2="65" y2="115" stroke="black" strokeWidth="2" />
              <line x1="20" y1="160" x2="35" y2="145" stroke="black" strokeWidth="2" />
              <line x1="80" y1="160" x2="65" y2="145" stroke="black" strokeWidth="2" />
            </g>
          )
        },
        {
          id: "hex_prism",
          answerDisplay: "å…­è§’æŸ±ï¼ˆã‚ã£ã‹ãã¡ã‚…ã†ï¼‰",
          description: "é‰›ç­†ã®ã‚ˆã†ãªå½¢ï¼ˆå‰Šã‚‹å‰ï¼‰ã§ã™ã€‚",
          hint: "æ­£é¢ã‹ã‚‰è¦‹ã‚‹ã¨3ã¤ã®é•·æ–¹å½¢ãŒä¸¦ã‚“ã§è¦‹ãˆã¾ã™ã€‚ä¸Šã‹ã‚‰è¦‹ã‚‹ã¨å…­è§’å½¢ã§ã™ã€‚",
          svgContent: (
            <g>
              <rect x="20" y="20" width="60" height="60" fill="none" stroke="black" strokeWidth="2" />
              <line x1="35" y1="20" x2="35" y2="80" stroke="black" strokeWidth="2" />
              <line x1="65" y1="20" x2="65" y2="80" stroke="black" strokeWidth="2" />
              <path d="M50,100 L76,115 L76,145 L50,160 L24,145 L24,115 Z" fill="none" stroke="black" strokeWidth="2" />
            </g>
          )
        },
        {
          id: "hex_pyramid",
          answerDisplay: "å…­è§’éŒï¼ˆã‚ã£ã‹ãã™ã„ï¼‰",
          description: "åº•é¢ãŒå…­è§’å½¢ã®ãƒ†ãƒ³ãƒˆã®ã‚ˆã†ãªå½¢ã§ã™ã€‚",
          hint: "æ­£é¢ã¯ä¸‰è§’å½¢ã®ä¸­ã«ç·šãŒå…¥ã£ã¦ã„ã¾ã™ã€‚ä¸Šã‹ã‚‰è¦‹ã‚‹ã¨ä¸­å¿ƒï¼ˆé ‚ç‚¹ï¼‰ã«å‘ã‹ã£ã¦ç·šãŒé›†ã¾ã£ã¦ã„ã¾ã™ã€‚",
          svgContent: (
            <g>
              <path d="M50,20 L20,80 L80,80 Z" fill="none" stroke="black" strokeWidth="2" />
              <line x1="50" y1="20" x2="35" y2="80" stroke="black" strokeWidth="2" />
              <line x1="50" y1="20" x2="65" y2="80" stroke="black" strokeWidth="2" />
              <path d="M50,100 L76,115 L76,145 L50,160 L24,145 L24,115 Z" fill="none" stroke="black" strokeWidth="2" />
              <line x1="50" y1="130" x2="50" y2="100" stroke="black" strokeWidth="2" />
              <line x1="50" y1="130" x2="76" y2="115" stroke="black" strokeWidth="2" />
              <line x1="50" y1="130" x2="76" y2="145" stroke="black" strokeWidth="2" />
              <line x1="50" y1="130" x2="50" y2="160" stroke="black" strokeWidth="2" />
              <line x1="50" y1="130" x2="24" y2="145" stroke="black" strokeWidth="2" />
              <line x1="50" y1="130" x2="24" y2="115" stroke="black" strokeWidth="2" />
            </g>
          )
        },
        {
          id: "half_cylinder",
          answerDisplay: "ã‹ã¾ã¼ã“å‹ï¼ˆåŠå††æŸ±ï¼‰",
          description: "å††æŸ±ã‚’ç¸¦ã«åŠåˆ†ã«åˆ‡ã£ã¦å¯ã‹ã›ãŸå½¢ã§ã™ã€‚",
          hint: "åŠçƒã®ç«‹é¢å›³ã¨ä¼¼ã¦ã„ã¾ã™ãŒã€å¹³é¢å›³ï¼ˆä¸Šã‹ã‚‰è¦‹ãŸå½¢ï¼‰ãŒå››è§’å½¢ã«ãªã£ã¦ã„ã¾ã™ï¼",
          svgContent: (
            <g>
              <path d="M20,80 A30,30 0 0,1 80,80 Z" fill="none" stroke="black" strokeWidth="2" />
              <line x1="20" y1="80" x2="80" y2="80" stroke="black" strokeWidth="2" />
              <rect x="20" y="100" width="60" height="60" fill="none" stroke="black" strokeWidth="2" />
            </g>
          )
        },
        {
          id: "pipe",
          answerDisplay: "ãƒ‘ã‚¤ãƒ—ï¼ˆä¸­ç©ºå††æŸ±ï¼‰",
          description: "ãƒˆã‚¤ãƒ¬ãƒƒãƒˆãƒšãƒ¼ãƒ‘ãƒ¼ã®èŠ¯ã®ã‚ˆã†ãªã€çœŸã‚“ä¸­ã«ç©´ãŒç©ºã„ãŸå††æŸ±ã§ã™ã€‚",
          hint: "ç‚¹ç·šï¼ˆç ´ç·šï¼‰ã¯ã€Œå¤–ã‹ã‚‰ã¯è¦‹ãˆãªã„éš ã‚ŒãŸç·šã€ã‚’è¡¨ã—ã¾ã™ã€‚ä¸­ã«ç©ºæ´ãŒã‚ã‚‹è¨¼æ‹ ã§ã™ã€‚",
          svgContent: (
            <g>
              <rect x="20" y="20" width="60" height="60" fill="none" stroke="black" strokeWidth="2" />
              <line x1="35" y1="20" x2="35" y2="80" stroke="black" strokeWidth="2" strokeDasharray="4,3" />
              <line x1="65" y1="20" x2="65" y2="80" stroke="black" strokeWidth="2" strokeDasharray="4,3" />
              <circle cx="50" cy="130" r="30" fill="none" stroke="black" strokeWidth="2" />
              <circle cx="50" cy="130" r="15" fill="none" stroke="black" strokeWidth="2" />
            </g>
          )
        },
        {
          id: "l_block",
          answerDisplay: "Lå­—å‹ãƒ–ãƒ­ãƒƒã‚¯",
          description: "ã‚¢ãƒ«ãƒ•ã‚¡ãƒ™ãƒƒãƒˆã®ã€ŒLã€ã®å½¢ã‚’ã—ãŸãƒ–ãƒ­ãƒƒã‚¯ã§ã™ã€‚",
          hint: "ä¸Šã‹ã‚‰è¦‹ã‚‹ã¨ã€é«˜ã„éƒ¨åˆ†ã¨ä½ã„éƒ¨åˆ†ã®å¢ƒç›®ã«ï¼‘æœ¬ã®ç·šãŒè¦‹ãˆã¾ã™ã€‚",
          svgContent: (
            <g>
              <path d="M20,20 L40,20 L40,60 L80,60 L80,80 L20,80 Z" fill="none" stroke="black" strokeWidth="2" />
              <rect x="20" y="100" width="60" height="60" fill="none" stroke="black" strokeWidth="2" />
              <line x1="40" y1="100" x2="40" y2="160" stroke="black" strokeWidth="2" />
            </g>
          )
        },
        {
          id: "step_block",
          answerDisplay: "éšæ®µå‹ãƒ–ãƒ­ãƒƒã‚¯",
          description: "ï¼’æ®µã®éšæ®µã®å½¢ã‚’ã—ãŸãƒ–ãƒ­ãƒƒã‚¯ã§ã™ã€‚",
          hint: "å®Ÿã¯ã€Œå®¶å‹ãƒ–ãƒ­ãƒƒã‚¯ã€ã¨å¹³é¢å›³ãŒã¾ã£ãŸãåŒã˜ã§ã™ï¼ç«‹é¢å›³ã§è¦‹åˆ†ã‘ã¾ã—ã‚‡ã†ã€‚",
          svgContent: (
            <g>
              <path d="M20,80 L20,50 L50,50 L50,20 L80,20 L80,80 Z" fill="none" stroke="black" strokeWidth="2" />
              <rect x="20" y="100" width="60" height="60" fill="none" stroke="black" strokeWidth="2" />
              <line x1="50" y1="100" x2="50" y2="160" stroke="black" strokeWidth="2" />
            </g>
          )
        },
        {
          id: "t_block",
          answerDisplay: "å‡¸å‹ãƒ–ãƒ­ãƒƒã‚¯",
          description: "å‡ºã£å¼µã‚Šã®ã‚ã‚‹ãƒ†ãƒˆãƒªã‚¹ã®ã‚ˆã†ãªãƒ–ãƒ­ãƒƒã‚¯ã§ã™ã€‚",
          hint: "ä¸Šã‹ã‚‰è¦‹ã‚‹ã¨ï¼“ã¤ã®å››è§’å½¢ãŒä¸¦ã‚“ã§ã„ã‚‹ã‚ˆã†ã«è¦‹ãˆã¾ã™ã€‚",
          svgContent: (
            <g>
              <path d="M35,20 L65,20 L65,50 L80,50 L80,80 L20,80 L20,50 L35,50 Z" fill="none" stroke="black" strokeWidth="2" />
              <rect x="20" y="100" width="60" height="60" fill="none" stroke="black" strokeWidth="2" />
              <line x1="35" y1="100" x2="35" y2="160" stroke="black" strokeWidth="2" />
              <line x1="65" y1="100" x2="65" y2="160" stroke="black" strokeWidth="2" />
            </g>
          )
        },
        {
          id: "house_block",
          answerDisplay: "å®¶å‹ãƒ–ãƒ­ãƒƒã‚¯ï¼ˆå¯ã‹ã›ãŸäº”è§’æŸ±ï¼‰",
          description: "ä¸‰è§’å±‹æ ¹ã®å®¶ã®ã‚ˆã†ãªå½¢ã§ã™ã€‚",
          hint: "éšæ®µå‹ãƒ–ãƒ­ãƒƒã‚¯ã¨å¹³é¢å›³ãŒåŒã˜ã§ã™ãŒã€æ¨ªã‹ã‚‰è¦‹ãŸå§¿ï¼ˆç«‹é¢å›³ï¼‰ãŒé•ã„ã¾ã™ã€‚",
          svgContent: (
            <g>
              <path d="M50,20 L80,50 L80,80 L20,80 L20,50 Z" fill="none" stroke="black" strokeWidth="2" />
              <rect x="20" y="100" width="60" height="60" fill="none" stroke="black" strokeWidth="2" />
              <line x1="50" y1="100" x2="50" y2="160" stroke="black" strokeWidth="2" />
            </g>
          )
        }
      ];

      // ==========================================
      // çŠ¶æ…‹ç®¡ç†ã¨ãƒ­ã‚¸ãƒƒã‚¯
      // ==========================================
      
      const [basicQuestions, setBasicQuestions] = useState(() => [...basicQuestionsData].sort(() => Math.random() - 0.5));
      const [advancedQuestions, setAdvancedQuestions] = useState(() => [...advancedQuestionsData].sort(() => Math.random() - 0.5));
      const [shuffledOptions, setShuffledOptions] = useState(() => [...basicOptions].sort(() => Math.random() - 0.5));

      const currentQuestions = mode === 'basic' ? basicQuestions : advancedQuestions;

      // ã‚²ãƒ¼ãƒ ã‚’æœ€åˆã‹ã‚‰ã‚¹ã‚¿ãƒ¼ãƒˆã™ã‚‹å‡¦ç†
      const startNewGame = (targetMode = mode) => {
        setQuizStatus('playing');
        setCurrentIndex(0);
        setScore(0);
        setStartTime(Date.now());
        setSelectedOptionId(null);
        setIsAnswered(false);

        if (targetMode === 'basic') {
          setBasicQuestions([...basicQuestionsData].sort(() => Math.random() - 0.5));
          setShuffledOptions([...basicOptions].sort(() => Math.random() - 0.5));
        } else {
          setAdvancedQuestions([...advancedQuestionsData].sort(() => Math.random() - 0.5));
          setShuffledOptions([...advancedOptions].sort(() => Math.random() - 0.5));
        }
      };

      const handleModeChange = (newMode) => {
        setMode(newMode);
        startNewGame(newMode);
      };

      const handleOptionClick = (optionId) => {
        if (isAnswered) return; // æ—¢ã«è§£ç­”æ¸ˆã¿ã®å ´åˆã¯ç„¡è¦–
        
        setSelectedOptionId(optionId);
        setIsAnswered(true);

        // æ­£è§£ãªã‚‰ã‚¹ã‚³ã‚¢ã‚¢ãƒƒãƒ—
        const currentQ = currentQuestions[currentIndex];
        if (optionId === currentQ.id) {
          setScore(prev => prev + 1);
        }
      };

      const handleNext = () => {
        if (currentIndex === currentQuestions.length - 1) {
          // æœ€å¾Œã®å•é¡Œãªã‚‰çµæœç”»é¢ã¸
          const timeMs = Date.now() - startTime;
          setTimeTaken(Math.floor(timeMs / 1000));
          setQuizStatus('result');
        } else {
          // æ¬¡ã®å•é¡Œã¸ï¼ˆçŠ¶æ…‹ã‚’ãƒªã‚»ãƒƒãƒˆã—ã¦å³åº§ã«åˆ‡ã‚Šæ›¿ãˆï¼‰
          setSelectedOptionId(null);
          setIsAnswered(false);
          setCurrentIndex((prev) => prev + 1);
          
          // é¸æŠè‚¢ã®ã‚·ãƒ£ãƒƒãƒ•ãƒ«
          const optionsToShuffle = mode === 'basic' ? basicOptions : advancedOptions;
          setShuffledOptions([...optionsToShuffle].sort(() => Math.random() - 0.5));
        }
      };

      // ã‚¿ã‚¤ãƒ ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆï¼ˆMM:SSï¼‰
      const formatTime = (seconds) => {
        const m = Math.floor(seconds / 60);
        const s = seconds % 60;
        return `${m}åˆ† ${s.toString().padStart(2, '0')}ç§’`;
      };


      // ==========================================
      // ãƒªã‚¶ãƒ«ãƒˆç”»é¢ã®ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°
      // ==========================================
      if (quizStatus === 'result') {
        const isPerfect = score === currentQuestions.length;
        const message = isPerfect ? "å…¨å•æ­£è§£ï¼ç´ æ™´ã‚‰ã—ã„ï¼" : 
                        score >= currentQuestions.length / 2 ? "ã‚ˆãã§ãã¾ã—ãŸï¼" : "ã‚‚ã†ä¸€åº¦ãƒãƒ£ãƒ¬ãƒ³ã‚¸ã—ã‚ˆã†ï¼";

        return (
          <div className="max-w-xl mx-auto p-4 bg-gray-100 min-h-screen font-sans text-gray-800 flex flex-col justify-center">
            <div className="bg-white rounded-2xl shadow-xl overflow-hidden border border-gray-200">
              
              <div className="bg-indigo-600 p-6 text-center text-white">
                <h2 className="text-3xl font-bold mb-2">çµæœç™ºè¡¨</h2>
                <p className="opacity-90">{message}</p>
              </div>

              <div className="p-8 text-center">
                <div className="flex justify-center mb-6">
                  {isPerfect ? (
                    <Trophy size={80} className="text-yellow-400 drop-shadow-md" />
                  ) : (
                    <CheckCircle size={80} className="text-green-500 drop-shadow-md" />
                  )}
                </div>

                <div className="grid grid-cols-2 gap-4 mb-8">
                  <div className="bg-gray-50 p-4 rounded-xl border border-gray-100">
                    <p className="text-sm text-gray-500 font-bold mb-1 flex items-center justify-center gap-1">
                      <CheckCircle size={16} /> æ­£è§£æ•°
                    </p>
                    <p className="text-3xl font-bold text-gray-800">
                      {score} <span className="text-lg text-gray-400">/ {currentQuestions.length}</span>
                    </p>
                  </div>
                  
                  <div className="bg-gray-50 p-4 rounded-xl border border-gray-100">
                    <p className="text-sm text-gray-500 font-bold mb-1 flex items-center justify-center gap-1">
                      <Clock size={16} /> ã‚¯ãƒªã‚¢ã‚¿ã‚¤ãƒ 
                    </p>
                    <p className="text-2xl font-bold text-gray-800 mt-1">
                      {formatTime(timeTaken)}
                    </p>
                  </div>
                </div>

                <div className="space-y-3">
                  <button 
                    onClick={() => startNewGame(mode)}
                    className="w-full py-4 bg-indigo-600 text-white font-bold rounded-xl hover:bg-indigo-700 shadow-sm transition active:scale-95 text-lg"
                  >
                    åŒã˜ãƒ¬ãƒ™ãƒ«ã‚’ã‚‚ã†ä¸€åº¦éŠã¶
                  </button>
                  
                  <button 
                    onClick={() => handleModeChange(mode === 'basic' ? 'advanced' : 'basic')}
                    className="w-full py-3 bg-white border-2 border-gray-200 text-gray-700 font-bold rounded-xl hover:bg-gray-50 transition active:scale-95"
                  >
                    {mode === 'basic' ? 'ğŸ”¥ ç™ºå±•ãƒ¬ãƒ™ãƒ«ã«æŒ‘æˆ¦ã™ã‚‹' : 'ğŸŸ¢ åŸºæœ¬ãƒ¬ãƒ™ãƒ«ã«æˆ»ã‚‹'}
                  </button>
                </div>
              </div>

            </div>
          </div>
        );
      }

      // ==========================================
      // ã‚¯ã‚¤ã‚ºç”»é¢ã®ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°
      // ==========================================
      const currentQ = currentQuestions[currentIndex];
      const isCorrect = selectedOptionId === currentQ.id;
      const gridClass = mode === 'basic' ? 'grid-cols-2 md:grid-cols-4' : 'grid-cols-2 sm:grid-cols-3 md:grid-cols-5';

      return (
        <div className="max-w-3xl mx-auto p-4 bg-gray-100 min-h-screen font-sans text-gray-800 flex flex-col">
          
          {/* Header */}
          <div className="mb-4 text-center">
            <h1 className="text-2xl font-bold text-indigo-700">æŠ•å½±å›³ã‚¯ã‚¤ã‚ºï¼šã“ã®ç«‹ä½“ãªãƒ¼ã‚“ã ï¼Ÿ</h1>
            <p className="text-sm text-gray-600 mt-1">ç«‹é¢å›³ï¼ˆå‰ï¼‰ã¨å¹³é¢å›³ï¼ˆä¸Šï¼‰ã‚’è¦‹ã¦ã€æ­£ã—ã„ç«‹ä½“ã‚’é¸ã¼ã†ï¼</p>
          </div>

          {/* Mode Switcher */}
          <div className="flex justify-center mb-4">
            <div className="bg-white p-1 rounded-lg flex shadow-sm border border-gray-200">
              <button 
                onClick={() => handleModeChange('basic')}
                className={`px-5 py-2 rounded-md text-sm font-bold transition-all ${mode === 'basic' ? 'bg-indigo-600 text-white shadow-sm' : 'text-gray-500 hover:text-gray-700 hover:bg-gray-50'}`}
              >
                åŸºæœ¬ãƒ¬ãƒ™ãƒ« (8å•)
              </button>
              <button 
                onClick={() => handleModeChange('advanced')}
                className={`px-5 py-2 rounded-md text-sm font-bold transition-all ${mode === 'advanced' ? 'bg-orange-500 text-white shadow-sm' : 'text-gray-500 hover:text-gray-700 hover:bg-gray-50'}`}
              >
                ç™ºå±•ãƒ¬ãƒ™ãƒ« (10å•)
              </button>
            </div>
          </div>

          {/* Control Bar */}
          <div className="flex justify-between items-center mb-4 bg-white px-4 py-3 rounded-lg shadow-sm border border-gray-200">
            <div className="text-sm font-bold bg-indigo-50 text-indigo-700 px-3 py-1 rounded-full">
              å•é¡Œ {currentIndex + 1} / {currentQuestions.length}
            </div>
            <button 
              onClick={() => startNewGame(mode)}
              className="flex items-center gap-1 text-sm text-gray-500 hover:text-indigo-600 transition"
            >
              <RefreshCw size={16} /> æœ€åˆã‹ã‚‰ã‚„ã‚Šç›´ã™
            </button>
          </div>

          {/* Main Card */}
          <div className="bg-white rounded-xl shadow-lg overflow-hidden border border-gray-200 mb-6 flex-grow">
            
            {/* Visualization Area */}
            <div className="p-6 flex flex-col justify-center items-center bg-white relative">
              
              {/* Projection Drawings */}
              <div className="w-56 h-56 border-2 border-dashed border-gray-200 rounded-lg relative mb-2">
                 <div className={`absolute top-2 left-2 text-xs px-2 py-1 rounded font-bold ${mode === 'basic' ? 'bg-indigo-100 text-indigo-700' : 'bg-orange-100 text-orange-700'}`}>
                    æŠ•å½±å›³ ({mode === 'basic' ? 'åŸºæœ¬' : 'ç™ºå±•'})
                 </div>
                 <svg viewBox="0 0 100 180" className="w-full h-full">
                   <text x="10" y="50" fontSize="8" fill="#999">ç«‹</text>
                   <text x="10" y="130" fontSize="8" fill="#999">å¹³</text>
                   <line x1="15" y1="90" x2="85" y2="90" stroke="#f0f0f0" strokeWidth="1" />
                   {currentQ.svgContent}
                   <line x1="20" y1="82" x2="20" y2="98" stroke="#ddd" strokeWidth="0.5" strokeDasharray="2" />
                   <line x1="80" y1="82" x2="80" y2="98" stroke="#ddd" strokeWidth="0.5" strokeDasharray="2" />
                 </svg>
              </div>

              {/* Feedback Area - æ¡ä»¶ä»˜ããƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã«ã‚ˆã‚Šä¸€ç¬è¦‹ãˆã‚‹ãƒã‚°ã‚’è§£æ¶ˆ */}
              <div className="w-full min-h-[120px] flex flex-col justify-center">
                {isAnswered ? (
                  <div className={`p-4 rounded-lg text-center animate-fade-in ${isCorrect ? 'bg-green-50 border border-green-200' : 'bg-red-50 border border-red-200'}`}>
                    <div className="flex justify-center items-center gap-2 mb-2">
                      {isCorrect ? (
                        <><CheckCircle className="text-green-600" size={24} /><span className="text-xl font-bold text-green-800">æ­£è§£ï¼</span></>
                      ) : (
                         <><XCircle className="text-red-600" size={24} /><span className="text-xl font-bold text-red-800">ã–ã‚“ã­ã‚“â€¦</span></>
                      )}
                    </div>
                    <div>
                      <p className="text-sm font-bold text-gray-500 mb-1">ç­”ãˆï¼š</p>
                      <h2 className="text-2xl font-bold text-gray-800 mb-2">{currentQ.answerDisplay}</h2>
                      <p className="text-sm text-gray-700 bg-white/60 inline-block px-3 py-1 rounded-full">
                        {currentQ.description}
                      </p>
                    </div>
                  </div>
                ) : (
                  <div className="bg-blue-50 text-blue-800 px-4 py-3 rounded-lg text-sm flex items-start gap-2 max-w-sm mx-auto animate-fade-in border border-blue-100">
                    <HelpCircle className="shrink-0 mt-0.5" size={18} />
                    <span><strong>ãƒ’ãƒ³ãƒˆï¼š</strong>{currentQ.hint}</span>
                  </div>
                )}
              </div>

            </div>

            {/* Options Area */}
            <div className="bg-gray-50 p-4 border-t border-gray-200">
              <p className="text-xs font-bold text-gray-500 mb-3 text-center uppercase tracking-wider">
                {isAnswered ? "è§£èª¬ã‚’èª­ã‚“ã ã‚‰æ¬¡ã¸é€²ã‚‚ã†" : "æ­£è§£ã‚’é¸ã‚“ã§ãã ã•ã„"}
              </p>
              
              <div className={`grid gap-2 ${gridClass}`}>
                {shuffledOptions.map((option) => {
                  const isSelected = selectedOptionId === option.id;
                  const isCorrectOption = currentQ.id === option.id;
                  
                  let buttonStyle = "bg-white border-gray-300 text-gray-700 hover:bg-indigo-50 hover:border-indigo-300";
                  
                  if (isAnswered) {
                    if (isCorrectOption) {
                      buttonStyle = "bg-green-100 border-green-500 text-green-800 font-bold ring-2 ring-green-200";
                    } else if (isSelected && !isCorrect) {
                      buttonStyle = "bg-red-100 border-red-400 text-red-800 opacity-70";
                    } else {
                      buttonStyle = "bg-gray-100 border-gray-200 text-gray-400 opacity-50";
                    }
                  }

                  return (
                    <button
                      key={option.id}
                      onClick={() => handleOptionClick(option.id)}
                      disabled={isAnswered}
                      className={`
                        py-3 px-2 rounded-lg border-2 text-sm transition-all duration-200 flex flex-col items-center justify-center
                        ${buttonStyle}
                        ${!isAnswered ? "active:scale-95 shadow-sm" : ""}
                      `}
                    >
                      <span className="font-bold text-base leading-tight text-center">{option.label}</span>
                      <span className="text-xs opacity-80 mt-1">{option.yomi}</span>
                    </button>
                  );
                })}
              </div>
            </div>
          </div>

          {/* Navigation Button */}
          <div className="flex justify-end">
            <button 
              onClick={handleNext}
              disabled={!isAnswered}
              className={`px-8 py-3 rounded-xl text-base font-bold flex items-center gap-2 transition-all ${
                isAnswered 
                  ? 'bg-indigo-600 text-white hover:bg-indigo-700 shadow-md transform scale-105' 
                  : 'bg-gray-200 text-gray-400 cursor-not-allowed opacity-50'
              }`}
            >
              {currentIndex === currentQuestions.length - 1 ? 'çµæœã‚’è¦‹ã‚‹' : 'æ¬¡ã®å•é¡Œã¸'} <ArrowRight size={20} />
            </button>
          </div>

        </div>
      );
    };

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<ShapeQuiz />);
  </script>
</body>
</html>